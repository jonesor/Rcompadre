<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Utilities for using the COM(P)ADRE Matrix Model Database • Rcompadre</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Utilities for using the COM(P)ADRE Matrix Model Database">
<meta name="description" content="Utility functions for interacting with the COMPADRE and COMADRE databases of matrix population models. Described in Jones et al. (2021) &lt;doi:10.1101/2021.04.26.441330&gt;.">
<meta property="og:description" content="Utility functions for interacting with the COMPADRE and COMADRE databases of matrix population models. Described in Jones et al. (2021) &lt;doi:10.1101/2021.04.26.441330&gt;.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">Rcompadre</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/a01_GettingStarted.html">Getting started with Rcompadre</a></li>
    <li><a class="dropdown-item" href="articles/a02_RcompadreTidy.html">Using Rcompadre with the tidyverse</a></li>
    <li><a class="dropdown-item" href="articles/a03_VectorisingRcompadre.html">Vectorising with Rcompadre</a></li>
    <li><a class="dropdown-item" href="articles/a04_ObtainingReferences.html">Obtaining references</a></li>
    <li><a class="dropdown-item" href="articles/a05_UsingYourOwnData.html">Using your own matrix data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/jonesor/Rcompadre/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="rcompadre-">Rcompadre <img src="reference/figures/logo_rcompadre.png" alt="rcompadre logo" align="right" height="160" style="float:right; height:160px;"><a class="anchor" aria-label="anchor" href="#rcompadre-"></a>
</h1></div>
<!--- Continuous integration badges --->
<!--- BE CAREFUL WITH THE FORMATTING --->
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>Project</th>
<th align="left">Main branch</th>
<th align="left">Devel branch</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><a href="https://www.gnu.org/licenses/gpl-3.0.html" class="external-link"><img src="https://img.shields.io/badge/License-GPL%20v3-blue.svg" alt="License: GPL v3"></a></td>
<td align="left"><a href="https://github.com/jonesor/Rcompadre/actions/workflows/main_check.yaml"><img src="https://github.com/jonesor/Rcompadre/actions/workflows/main_check.yaml/badge.svg" alt="R-CMD-check"></a></td>
<td align="left"><a href="https://github.com/jonesor/Rcompadre/actions/workflows/devel_build_check.yaml"><img src="https://github.com/jonesor/Rcompadre/actions/workflows/devel_build_check.yaml/badge.svg" alt="R-CMD-check"></a></td>
</tr>
<tr class="even">
<td><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active - The project has reached a stable, usable state and is being actively developed."></a></td>
<td align="left"><a href="https://app.codecov.io/gh/jonesor/Rcompadre" class="external-link"><img src="https://codecov.io/gh/jonesor/Rcompadre/branch/main/graph/badge.svg?token=S9G2a5K9k9" alt="codecov"></a></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td><img src="http://cranlogs.r-pkg.org/badges/grand-total/Rcompadre" alt="Grand Total"></td>
<td align="left"><a href="https://cran.r-project.org/package=Rcompadre" class="external-link"><img src="https://www.r-pkg.org/badges/version/Rcompadre" alt="CRAN_Status_Badge"></a></td>
<td align="left"></td>
</tr>
<tr class="even">
<td><img src="http://cranlogs.r-pkg.org/badges/Rcompadre" alt="CRAN"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<!--- Continuous Integration Badges End ---><p>An R package to facilitate working with the <a href="https://compadre-db.org/" class="external-link">COM(P)ADRE</a> Plant and Animal Matrix Population Databases.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the stable release package from CRAN with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"Rcompadre"</span><span class="op">)</span></span></code></pre></div>
<p>Install the package from GitHub with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install package 'remotes' if necessary</span></span>
<span><span class="co"># will already be installed if 'devtools' is installed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># argument 'build_opts = NULL' only needed if you want to build vignettes</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"jonesor/Rcompadre"</span>, build_opts <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p>To install from the development branch use:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"jonesor/Rcompadre"</span>, ref <span class="op">=</span> <span class="st">"devel"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jonesor/Rcompadre">Rcompadre</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="fetching-a-database">Fetching a database<a class="anchor" aria-label="anchor" href="#fetching-a-database"></a>
</h4>
<p>Fetch the most recent database version from <a href="https://compadre-db.org/" class="external-link">compadre-db.org</a> with</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compadre</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cdb_fetch.html">cdb_fetch</a></span><span class="op">(</span><span class="st">"compadre"</span><span class="op">)</span> <span class="co"># or use 'comadre' for the animal database</span></span></code></pre></div>
<p>or load from a local <code>.RData</code> file with</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compadre</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cdb_fetch.html">cdb_fetch</a></span><span class="op">(</span><span class="st">"path/to/file/COMPADRE_v.4.0.1.RData"</span><span class="op">)</span></span></code></pre></div>
<p>If you prefer using <code><a href="https://rdrr.io/r/base/load.html" class="external-link">load()</a></code> to load your local copy of a legacy database, use <code><a href="reference/as_cdb.html">as_cdb()</a></code> to convert it to the <code>CompadreDB</code> class</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"COMPADRE_v.4.0.1.RData"</span><span class="op">)</span> <span class="co"># loads object 'compadre'</span></span>
<span><span class="va">compadre</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_cdb.html">as_cdb</a></span><span class="op">(</span><span class="va">compadre</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="subsetting">Subsetting<a class="anchor" aria-label="anchor" href="#subsetting"></a>
</h4>
<p>For the most part <code>CompadreDB</code> objects work like a data frame. They can be subset using <code>[</code>, <code><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset()</a></code> or <code><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter()</a></code></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subset to the first 10 rows</span></span>
<span><span class="va">compadre</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># subset to the species 'Echinacea angustifolia'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">compadre</span>, <span class="va">SpeciesAccepted</span> <span class="op">==</span> <span class="st">"Echinacea angustifolia"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># subset to the species 'Echinacea angustifolia'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">compadre</span>, <span class="va">SpeciesAccepted</span> <span class="op">==</span> <span class="st">"Echinacea angustifolia"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="example-analysis-calculating-population-growth-rates">Example analysis: calculating population growth rates<a class="anchor" aria-label="anchor" href="#example-analysis-calculating-population-growth-rates"></a>
</h4>
<p>First we’ll use the function <code><a href="reference/cdb_flag.html">cdb_flag()</a></code> to add columns to the database flagging potential issues with the projection matrices, such as missing values, or matrices that don’t meet assumptions like ergodicity, irreducibility, or primitivity.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compadre_flags</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cdb_flag.html">cdb_flag</a></span><span class="op">(</span><span class="va">compadre</span><span class="op">)</span></span></code></pre></div>
<p>We’ll only be able to calculate population growth rates from matrices that don’t contain missing values, and we only want to use matrices that meet the assumption of ergodicity, so we’ll subset the database accordingly.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compadre_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span></span>
<span>  <span class="va">compadre_flags</span>,</span>
<span>  <span class="va">check_NA_A</span> <span class="op">==</span> <span class="cn">FALSE</span> <span class="op">&amp;</span> <span class="va">check_ergodic</span> <span class="op">==</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Finally, we’ll use the <code>eigs()</code> function from the <a href="https://CRAN.R-project.org/package=popdemo" class="external-link">popdemo</a> package to calculate the population growth rate for every matrix in <code>compadre_sub</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compadre_sub</span><span class="op">$</span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="reference/CompadreMatrixMethods.html">matA</a></span><span class="op">(</span><span class="va">compadre_sub</span><span class="op">)</span>, <span class="fu">popdemo</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/popdemo/man/eigs.html" class="external-link">eigs</a></span>, what <span class="op">=</span> <span class="st">"lambda"</span><span class="op">)</span></span></code></pre></div>
<p>In the code above, the accessor function <code><a href="reference/CompadreMatrixMethods.html">matA()</a></code> is used to extract a list of projection matrices (the full matrix, <code>matA</code>) from every row of <code>compadre_sub</code>. There are also accessor functions for the matrix subcomponents (<code><a href="reference/CompadreMatrixMethods.html">matU()</a></code>, <code><a href="reference/CompadreMatrixMethods.html">matF()</a></code>, <code><a href="reference/CompadreMatrixMethods.html">matC()</a></code>), and for many other parts of the database too.</p>
</div>
</div>
<div class="section level2">
<h2 id="previous-releases">Previous releases<a class="anchor" aria-label="anchor" href="#previous-releases"></a>
</h2>
<p>Specific earlier releases of this package can be installed using the appropriate <code>@</code> tag.</p>
<p>For example to install version 0.1.0:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"jonesor/Rcompadre@v0.1.0"</span><span class="op">)</span></span></code></pre></div>
<p>See the Changelog for more details.</p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>Jones, Owen R., Patrick Barks, Iain M. Stott, Tamora D. James, Sam C. Levin, William K. Petry, Pol Capdevila, et al. 2022. “Rcompadre and Rage – Two R Packages to Facilitate the Use of the COMPADRE and COMADRE Databases and Calculation of Life History Traits from Matrix Population Models.” <em>Methods in Ecology and Evolution</em>. doi: 10.1111/2041-210X.13792.</p>
</div>
<div class="section level2">
<h2 id="contributions">Contributions<a class="anchor" aria-label="anchor" href="#contributions"></a>
</h2>
<p>All contributions are welcome. Please note that this project is released with a <a href="https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html" class="external-link">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms.</p>
<p>There are numerous ways of contributing.</p>
<ol style="list-style-type: decimal">
<li><p>You can submit bug reports, suggestions etc. by <a href="https://github.com/jonesor/Rcompadre/issues">opening an issue</a>.</p></li>
<li><p>You can copy or fork the repository, make your own code edits and then send us a pull request. <a href="https://jarv.is/notes/how-to-pull-request-fork-github/" class="external-link">Here’s how to do that</a>.</p></li>
<li><p>You can get to know us and join as a collaborator on the main repository.</p></li>
<li><p>You are also welcome to email us.</p></li>
</ol>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=Rcompadre" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/jonesor/Rcompadre/">Browse source code</a></li>
<li><a href="https://github.com/jonesor/Rcompadre/issues">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing Rcompadre</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Patrick Barks <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-5947-8151" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Danny Buss <br><small class="roles"> Author </small>  </li>
<li>Roberto Salguero-Gomez <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-6085-4433" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Iain Stott <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-2724-7436" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>William K. Petry <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-5230-5987" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Tamora James <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-1363-4742" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Owen Jones <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-5720-4686" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Julia Jones <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-9223-1778" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Gesa Römer <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-4859-5870" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Sam Levin <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-3289-9925" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patrick Barks, Danny Buss, Roberto Salguero-Gomez, Iain Stott, William K. Petry, Tamora James, Owen Jones, Julia Jones, Gesa Römer, Sam Levin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
