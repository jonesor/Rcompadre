<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Flag potential issues in matrices of a COM(P)ADRE database — cdb_flag • Rcompadre</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Flag potential issues in matrices of a COM(P)ADRE database — cdb_flag"><meta name="description" content="Adds columns to the data slot of a `CompadreDB` object that flag potential
problems in the matrix population models. These columns can subsequently be
used to subset the database by logical argument.
Optional checks include:
check_NA_A: missing values in `matA`? Missing (`NA`) values in
  matrices prevent most calculations using those matrices.
check_NA_U: missing values in `matU`? Missing (`NA`) values in
  matrices prevent most calculations using those matrices.
check_NA_F: missing values in `matF`? Missing (`NA`) values in
  matrices prevent most calculations using those matrices.
check_NA_C: missing values in `matC`? Missing (`NA`) values in
  matrices prevent most calculations using those matrices.
check_zero_U: `matU` all zeros (including `NA`)? Submatrices
  composed entirely of zero values can be problematic. There may be good
  biological reasons for this phenomenon. For example, in the particular
  focal population in the particular focal year, there was truly zero
  survival recorded. Nevertheless, zero-value submatrices can cause some
  calculations to fail and it may be necessary to exclude them.
check_zero_F: `matF` all zeros (including `NA`)? Submatrices
  composed entirely of zero values can be problematic. There may be good
  biological reasons for this phenomenon. For example, in the particular
  focal population in the particular focal year, there was truly zero
  reproduction recorded. Nevertheless, zero-value submatrices can cause some
  calculations to fail and it may be necessary to exclude them.
check_zero_U_colsum: Columns of `matU` that sum to zero imply
  that there is is no survival from that particular stage. This may be a
  perfectly valid parameterisation for a particular year/place but is
  biologically unreasonable in the longer term and users may wish to exclude
  problematic matrices from their analysis.
check_singular_U: `matU` singular? Matrices are said to be
  singular if they cannot be inverted. Inversion is required for many matrix
  calculations and, therefore, singularity can cause some calculations to
  fail.
check_component_sum: do `matU`/`matF`/`matC` submatrices sum
  to `matA` (see Details)? A complete MPM (`matA`) can be split into
  its component submatrices (i.e., `matU`, `matF` and  `matC`). The sum of
  these submatrices should equal the complete MPM (i.e., `matA` = `matU` +
  `matF` + `matC`). Sometimes, however, errors occur so that the submatrices
  do NOT sum to `matA`. Normally, this is caused by rounding errors, but more
  significant errors are possible.
check_ergodic: is `matA` ergodic (see
  isErgodic)? Some matrix calculations require that
  the MPM (`matA`) be ergodic. Ergodic MPMs are those where there is a single
  asymptotic stable state that does not depend on initial stage structure.
  Conversely, non-ergodic MPMs are those where there are multiple asymptotic
  stable states, which depend on initial stage structure. MPMs that are
  non-ergodic are usually biologically unreasonable, both in terms of their
  life cycle description and their projected dynamics. They cause some
  calculations to fail.
check_irreducible: is `matA` irreducible (see
  isIrreducible)? Some matrix calculations require
  that the MPM (`matA`) be irreducible. Irreducible MPMs are those where
  parameterised transition rates facilitate pathways from all stages to all
  other stages. Conversely, reducible MPMs depict incomplete life cycles
  where pathways from all stages to every other stage are not possible. MPMs
  that are reducible are usually biologically unreasonable, both in terms of
  their life cycle description and their projected dynamics. They cause some
  calculations to fail. Irreducibility is necessary but not sufficient for
  ergodicity.
check_primitive: is `matA` primitive (see
  isPrimitive)? A primitive matrix is non-negative
  matrix that is irreducible and has only a single eigenvalue of maximum
  modulus. This check is therefore redundant due to the overlap with
  `check_irreducible` and `checkErdogic`.
check_surv_gte_1: does `matU` contains values that are equal
  to or greater than 1? Survival is bounded between 0 and 1. Values in excess
  of 1 are biologically unreasonable.

"><meta property="og:description" content="Adds columns to the data slot of a `CompadreDB` object that flag potential
problems in the matrix population models. These columns can subsequently be
used to subset the database by logical argument.
Optional checks include:
check_NA_A: missing values in `matA`? Missing (`NA`) values in
  matrices prevent most calculations using those matrices.
check_NA_U: missing values in `matU`? Missing (`NA`) values in
  matrices prevent most calculations using those matrices.
check_NA_F: missing values in `matF`? Missing (`NA`) values in
  matrices prevent most calculations using those matrices.
check_NA_C: missing values in `matC`? Missing (`NA`) values in
  matrices prevent most calculations using those matrices.
check_zero_U: `matU` all zeros (including `NA`)? Submatrices
  composed entirely of zero values can be problematic. There may be good
  biological reasons for this phenomenon. For example, in the particular
  focal population in the particular focal year, there was truly zero
  survival recorded. Nevertheless, zero-value submatrices can cause some
  calculations to fail and it may be necessary to exclude them.
check_zero_F: `matF` all zeros (including `NA`)? Submatrices
  composed entirely of zero values can be problematic. There may be good
  biological reasons for this phenomenon. For example, in the particular
  focal population in the particular focal year, there was truly zero
  reproduction recorded. Nevertheless, zero-value submatrices can cause some
  calculations to fail and it may be necessary to exclude them.
check_zero_U_colsum: Columns of `matU` that sum to zero imply
  that there is is no survival from that particular stage. This may be a
  perfectly valid parameterisation for a particular year/place but is
  biologically unreasonable in the longer term and users may wish to exclude
  problematic matrices from their analysis.
check_singular_U: `matU` singular? Matrices are said to be
  singular if they cannot be inverted. Inversion is required for many matrix
  calculations and, therefore, singularity can cause some calculations to
  fail.
check_component_sum: do `matU`/`matF`/`matC` submatrices sum
  to `matA` (see Details)? A complete MPM (`matA`) can be split into
  its component submatrices (i.e., `matU`, `matF` and  `matC`). The sum of
  these submatrices should equal the complete MPM (i.e., `matA` = `matU` +
  `matF` + `matC`). Sometimes, however, errors occur so that the submatrices
  do NOT sum to `matA`. Normally, this is caused by rounding errors, but more
  significant errors are possible.
check_ergodic: is `matA` ergodic (see
  isErgodic)? Some matrix calculations require that
  the MPM (`matA`) be ergodic. Ergodic MPMs are those where there is a single
  asymptotic stable state that does not depend on initial stage structure.
  Conversely, non-ergodic MPMs are those where there are multiple asymptotic
  stable states, which depend on initial stage structure. MPMs that are
  non-ergodic are usually biologically unreasonable, both in terms of their
  life cycle description and their projected dynamics. They cause some
  calculations to fail.
check_irreducible: is `matA` irreducible (see
  isIrreducible)? Some matrix calculations require
  that the MPM (`matA`) be irreducible. Irreducible MPMs are those where
  parameterised transition rates facilitate pathways from all stages to all
  other stages. Conversely, reducible MPMs depict incomplete life cycles
  where pathways from all stages to every other stage are not possible. MPMs
  that are reducible are usually biologically unreasonable, both in terms of
  their life cycle description and their projected dynamics. They cause some
  calculations to fail. Irreducibility is necessary but not sufficient for
  ergodicity.
check_primitive: is `matA` primitive (see
  isPrimitive)? A primitive matrix is non-negative
  matrix that is irreducible and has only a single eigenvalue of maximum
  modulus. This check is therefore redundant due to the overlap with
  `check_irreducible` and `checkErdogic`.
check_surv_gte_1: does `matU` contains values that are equal
  to or greater than 1? Survival is bounded between 0 and 1. Values in excess
  of 1 are biologically unreasonable.

"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Rcompadre</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a01_GettingStarted.html">Getting started with Rcompadre</a></li>
    <li><a class="dropdown-item" href="../articles/a02_RcompadreTidy.html">Using Rcompadre with the tidyverse</a></li>
    <li><a class="dropdown-item" href="../articles/a03_VectorisingRcompadre.html">Vectorising with Rcompadre</a></li>
    <li><a class="dropdown-item" href="../articles/a04_ObtainingReferences.html">Obtaining references</a></li>
    <li><a class="dropdown-item" href="../articles/a05_UsingYourOwnData.html">Using your own matrix data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/jonesor/Rcompadre/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Flag potential issues in matrices of a COM(P)ADRE database</h1>
      <small class="dont-index">Source: <a href="https://github.com/jonesor/Rcompadre/blob/HEAD/R/cdb_flag.R"><code>R/cdb_flag.R</code></a></small>
      <div class="d-none name"><code>cdb_flag.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Adds columns to the data slot of a `CompadreDB` object that flag potential
problems in the matrix population models. These columns can subsequently be
used to subset the database by logical argument.</p>
<p>Optional checks include:</p><ul><li><p><code>check_NA_A</code>: missing values in `matA`? Missing (`NA`) values in
  matrices prevent most calculations using those matrices.</p></li>
<li><p><code>check_NA_U</code>: missing values in `matU`? Missing (`NA`) values in
  matrices prevent most calculations using those matrices.</p></li>
<li><p><code>check_NA_F</code>: missing values in `matF`? Missing (`NA`) values in
  matrices prevent most calculations using those matrices.</p></li>
<li><p><code>check_NA_C</code>: missing values in `matC`? Missing (`NA`) values in
  matrices prevent most calculations using those matrices.</p></li>
<li><p><code>check_zero_U</code>: `matU` all zeros (including `NA`)? Submatrices
  composed entirely of zero values can be problematic. There may be good
  biological reasons for this phenomenon. For example, in the particular
  focal population in the particular focal year, there was truly zero
  survival recorded. Nevertheless, zero-value submatrices can cause some
  calculations to fail and it may be necessary to exclude them.</p></li>
<li><p><code>check_zero_F</code>: `matF` all zeros (including `NA`)? Submatrices
  composed entirely of zero values can be problematic. There may be good
  biological reasons for this phenomenon. For example, in the particular
  focal population in the particular focal year, there was truly zero
  reproduction recorded. Nevertheless, zero-value submatrices can cause some
  calculations to fail and it may be necessary to exclude them.</p></li>
<li><p><code>check_zero_U_colsum</code>: Columns of `matU` that sum to zero imply
  that there is is no survival from that particular stage. This may be a
  perfectly valid parameterisation for a particular year/place but is
  biologically unreasonable in the longer term and users may wish to exclude
  problematic matrices from their analysis.</p></li>
<li><p><code>check_singular_U</code>: `matU` singular? Matrices are said to be
  singular if they cannot be inverted. Inversion is required for many matrix
  calculations and, therefore, singularity can cause some calculations to
  fail.</p></li>
<li><p><code>check_component_sum</code>: do `matU`/`matF`/`matC` submatrices sum
  to `matA` (see <em>Details</em>)? A complete MPM (`matA`) can be split into
  its component submatrices (i.e., `matU`, `matF` and  `matC`). The sum of
  these submatrices should equal the complete MPM (i.e., `matA` = `matU` +
  `matF` + `matC`). Sometimes, however, errors occur so that the submatrices
  do NOT sum to `matA`. Normally, this is caused by rounding errors, but more
  significant errors are possible.</p></li>
<li><p><code>check_ergodic</code>: is `matA` ergodic (see
  <code><a href="https://rdrr.io/pkg/popdemo/man/isErgodic.html" class="external-link">isErgodic</a></code>)? Some matrix calculations require that
  the MPM (`matA`) be ergodic. Ergodic MPMs are those where there is a single
  asymptotic stable state that does not depend on initial stage structure.
  Conversely, non-ergodic MPMs are those where there are multiple asymptotic
  stable states, which depend on initial stage structure. MPMs that are
  non-ergodic are usually biologically unreasonable, both in terms of their
  life cycle description and their projected dynamics. They cause some
  calculations to fail.</p></li>
<li><p><code>check_irreducible</code>: is `matA` irreducible (see
  <code><a href="https://rdrr.io/pkg/popdemo/man/isIrreducible.html" class="external-link">isIrreducible</a></code>)? Some matrix calculations require
  that the MPM (`matA`) be irreducible. Irreducible MPMs are those where
  parameterised transition rates facilitate pathways from all stages to all
  other stages. Conversely, reducible MPMs depict incomplete life cycles
  where pathways from all stages to every other stage are not possible. MPMs
  that are reducible are usually biologically unreasonable, both in terms of
  their life cycle description and their projected dynamics. They cause some
  calculations to fail. Irreducibility is necessary but not sufficient for
  ergodicity.</p></li>
<li><p><code>check_primitive</code>: is `matA` primitive (see
  <code><a href="https://rdrr.io/pkg/popdemo/man/isPrimitive.html" class="external-link">isPrimitive</a></code>)? A primitive matrix is non-negative
  matrix that is irreducible and has only a single eigenvalue of maximum
  modulus. This check is therefore redundant due to the overlap with
  `check_irreducible` and `checkErdogic`.</p></li>
<li><p><code>check_surv_gte_1</code>: does `matU` contains values that are equal
  to or greater than 1? Survival is bounded between 0 and 1. Values in excess
  of 1 are biologically unreasonable.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cdb_flag</span><span class="op">(</span></span>
<span>  <span class="va">cdb</span>,</span>
<span>  checks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"check_NA_A"</span>, <span class="st">"check_NA_U"</span>, <span class="st">"check_NA_F"</span>, <span class="st">"check_NA_C"</span>, <span class="st">"check_zero_U"</span>,</span>
<span>    <span class="st">"check_zero_F"</span>, <span class="st">"check_zero_C"</span>, <span class="st">"check_zero_U_colsum"</span>, <span class="st">"check_singular_U"</span>,</span>
<span>    <span class="st">"check_component_sum"</span>, <span class="st">"check_ergodic"</span>, <span class="st">"check_irreducible"</span>, <span class="st">"check_primitive"</span>,</span>
<span>    <span class="st">"check_surv_gte_1"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cdb">cdb<a class="anchor" aria-label="anchor" href="#arg-cdb"></a></dt>
<dd><p>A CompadreDB object</p></dd>


<dt id="arg-checks">checks<a class="anchor" aria-label="anchor" href="#arg-checks"></a></dt>
<dd><p>Character vector specifying which checks to run.</p>
<p>Defaults to all, i.e. <code>c("check_NA_A", "check_NA_U", "check_NA_F",
  "check_NA_C", "check_zero_U", "check_singular_U", "check_component_sum",
  "check_ergodic", "check_irreducible", "check_primitive",
  "check_surv_gte_1")</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns <code>cdb</code> with extra columns appended to the data slot
  (columns have the same names as the corresponding elements of
  <code>checks</code>) to indicate (TRUE/FALSE) whether there are potential
  problems with the matrices corresponding to a given row of the data.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For the flag <code>check_component_sum</code>, a value of <code>NA</code> will be
returned if the matrix sum of matU, matF, and matC consists only of zeros
and/or <code>NA</code>, indicating that the matrix has not been split.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Stott, I., Townley, S., &amp; Carslake, D. 2010. On reducibility and
  ergodicity of population projection matrix models. Methods in Ecology and
  Evolution. 1 (3), 242-252</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other data checking:
<code><a href="cdb_check_species.html">cdb_check_species</a>()</code>,
<code><a href="cdb_collapse.html">cdb_collapse</a>()</code>,
<code><a href="cdb_compare.html">cdb_compare</a>()</code>,
<code><a href="mpm_methods.html">mpm_methods</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Owen Jones &lt;jones@biology.sdu.dk&gt;</p>
<p>Julia Jones &lt;juliajones@biology.sdu.dk&gt;</p>
<p>Roberto Salguero-Gomez &lt;rob.salguero@zoo.ox.ac.uk&gt;</p>
<p>Danny Buss &lt;dlb50@cam.ac.uk&gt;</p>
<p>Patrick Barks &lt;patrick.barks@gmail.com&gt;</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">CompadreFlag</span> <span class="op">&lt;-</span> <span class="fu">cdb_flag</span><span class="op">(</span><span class="va">Compadre</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># only check whether matA has missing values, and whether matA is ergodic</span></span></span>
<span class="r-in"><span><span class="va">CompadreFlag</span> <span class="op">&lt;-</span> <span class="fu">cdb_flag</span><span class="op">(</span><span class="va">Compadre</span>, checks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"check_NA_A"</span>, <span class="st">"check_ergodic"</span><span class="op">)</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patrick Barks, Danny Buss, Roberto Salguero-Gomez, Iain Stott, William K. Petry, Tamora James, Owen Jones, Julia Jones, Gesa Römer, Sam Levin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

