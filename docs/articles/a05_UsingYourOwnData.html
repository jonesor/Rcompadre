<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using your own matrix data • Rcompadre</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using your own matrix data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Rcompadre</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a01_GettingStarted.html">Getting started with Rcompadre</a></li>
    <li><a class="dropdown-item" href="../articles/a02_RcompadreTidy.html">Using Rcompadre with the tidyverse</a></li>
    <li><a class="dropdown-item" href="../articles/a03_VectorisingRcompadre.html">Vectorising with Rcompadre</a></li>
    <li><a class="dropdown-item" href="../articles/a04_ObtainingReferences.html">Obtaining references</a></li>
    <li><a class="dropdown-item" href="../articles/a05_UsingYourOwnData.html">Using your own matrix data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/jonesor/Rcompadre/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using your own matrix data</h1>
                        <h4 data-toc-skip class="author">Owen Jones</h4>
            
            <h4 data-toc-skip class="date">2024-10-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jonesor/Rcompadre/blob/HEAD/vignettes/a05_UsingYourOwnData.Rmd"><code>vignettes/a05_UsingYourOwnData.Rmd</code></a></small>
      <div class="d-none name"><code>a05_UsingYourOwnData.Rmd</code></div>
    </div>

    
    
<p>The utility of <code>Rcompadre</code> extends beyond the use of data
from the COMPADRE and COMADRE matrix databases. By coercing
user-provided matrix population model (MPM) data (and metadata) into the
standardised format used by the <code>Rcompadre</code> package (a
<code>CompadreDB</code> object) you can make use of all the
functionality of the package. The central function to carry out this is
<code><a href="../reference/cdb_build_cdb.html">cdb_build_cdb()</a></code>.</p>
<p>This vignette illustrates some simple use cases.</p>
<div class="section level3">
<h3 id="the-compadredb-object">The <code>CompadreDB</code> object<a class="anchor" aria-label="anchor" href="#the-compadredb-object"></a>
</h3>
<p>Before illustrating the construction of a <code>CompadreDB</code>
object using <code><a href="../reference/cdb_build_cdb.html">cdb_build_cdb()</a></code> is it first necessary to
outline the anatomy of the object.</p>
<p>The <code>CompadreDB</code> object consists of four parts: (1) the
matrices; (2) the stage information; (3) the metadata describing the
matrices; and (4) version information. Much of this information can be
generated automatically by the <code><a href="../reference/cdb_build_cdb.html">cdb_build_cdb()</a></code>
function.</p>
<div class="section level4">
<h4 id="the-matrices">The matrices<a class="anchor" aria-label="anchor" href="#the-matrices"></a>
</h4>
<p>MPM data can exist as <em>A</em> matrices (i.e. the whole MPM model)
but can also exist as a series of submatrices that sum to the <em>A</em>
matrix. Typically these matrices are based on demographic processes such
as growth and survival, sexual reproduction and clonal reproduction.
These matrices are commonly denoted as the <em>U</em>, <em>F</em> and
<em>C</em> matrices respectively, and <em>A</em> = <em>U</em> +
<em>F</em> + <em>C</em> (Caswell 2001, Salguero-Gomez et al. 2015,
2016).</p>
<p>Thus, each MPM in the <code>CompadreDB</code> object is provided as a
list object with four elements representing this set of matrices:
<em>A</em>, the full MPM and the three demographic process-based
submatrices (<em>U</em>, <em>F</em> and <em>C</em>).</p>
<p>In some cases it is not desirable (or perhaps impossible) to provide
information for the set of submatrices. For example, it may not be
possible to distinguish between sexual (<em>F</em>) and clonal
(<em>C</em>) reproduction, or between growth/survival (<em>U</em>) and
reproduction (<em>F</em> and/or <em>C</em>). Alternatively, it may
simply be that the planned analyses do not require the potentially
laborious splitting of the <em>A</em> matrix into these submatrices.
Nevertheless, <code>CompadreDB</code> requires the full set of four
matrices. Thankfully, the matrices can be provided as <code>NA</code>
matrices and can often be generated automatically from the provided data
(see below).</p>
<ul>
<li>If only the <em>A</em> matrices are provided,
<code><a href="../reference/cdb_build_cdb.html">cdb_build_cdb()</a></code> will automatically populate the <em>U</em>,
<em>F</em> and <em>c</em> matrices with <code>NA</code> values.</li>
<li>If a <em>U</em> matrix is provided, an <em>F</em> and/or <em>C</em>
matrix must also be provided. If only one of the <em>F</em> and
<em>C</em> matrices is provided, the other is assumed to be 0. The
<em>A</em> matrix is then calculated automatically from these sets as
<em>A</em> = <em>U</em> + <em>F</em> + <em>C</em>.</li>
</ul>
<p>Sets of matrices of the same type must be provided as a
<code>list</code> for each type. For example, you could provide two
lists: one for the <em>U</em> matrices and one for the matching
<em>F</em> matrices. The function conducts some error checks to ensure
that these lists have the same length, and that all matrices in each set
has the same dimensions.</p>
</div>
<div class="section level4">
<h4 id="the-stage-information">The stage information<a class="anchor" aria-label="anchor" href="#the-stage-information"></a>
</h4>
<p>Each MPM has a life-cycle divided into two or more discrete stages.
The <code>CompadreDB</code> object must include this information, and it
is provided as a <code>list</code> of <code>data.frame</code>s (one for
each MPM).</p>
</div>
<div class="section level4">
<h4 id="the-metadata">The metadata<a class="anchor" aria-label="anchor" href="#the-metadata"></a>
</h4>
<p>A valid <code>CompadreDB</code> object MUST include a
<code>data.frame</code> of metadata with a number of rows equal to the
number of MPMs.</p>
<p>This metadata, can be minimal or very extensive, depending on the
users’ needs. In the simplest case, for example with simulated data,
this might simply be an ID number, or perhaps parameters used in
simulation. In cases with empirical MPMs the metadata will typically
include taxonomic information on the species, the geographic location,
the name of the study site, the year or time-frame of study and so on.
Thus, the metadata data.frame can include anything from one to hundreds
of columns.</p>
</div>
<div class="section level4">
<h4 id="version-information">Version information<a class="anchor" aria-label="anchor" href="#version-information"></a>
</h4>
<p>Finally, some version information must be included. This can simply
be a name, or a date intended to help keep track of multiple version of
the data.</p>
</div>
</div>
<div class="section level3">
<h3 id="data-preparation">Data preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h3>
<p>The main function used for creating a <code>CompadreDB</code> object
from user-defined data is <code><a href="../reference/cdb_build_cdb.html">cdb_build_cdb()</a></code>. This function
takes the components described above, performs some error checks, and
combines them into a single <code>CompadreDB</code> object.</p>
</div>
<div class="section level2">
<h2 id="a-simple-example">A simple example<a class="anchor" aria-label="anchor" href="#a-simple-example"></a>
</h2>
<p>First we need to load the library, and the <code>dplyr</code>
package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jonesor/Rcompadre">Rcompadre</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
<p>In this example we generate a series of 2 dimension <em>A</em>
matrices using a series of uniform distributions for the <em>U</em>
submatrix, and a gamma distribution, to approximate the average of a
Poisson process. In this case, the matrices all have the same dimension,
but it is not necessary for dimension to be the same. This is a bit
long-winded, and there are certainly better ways to simulate these data
(e.g. using a Dirichlet distribution), but the example serves a useful
purpose here.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nMat</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">mort1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nMat</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">u1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nMat</span>, <span class="fl">0</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">mort1</span><span class="op">)</span></span>
<span><span class="va">u2</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">mort1</span> <span class="op">-</span> <span class="va">u1</span></span>
<span><span class="va">mort2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nMat</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">u3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nMat</span>, <span class="fl">0</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">mort2</span><span class="op">)</span></span>
<span><span class="va">u4</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">mort2</span> <span class="op">-</span> <span class="va">u3</span></span>
<span></span>
<span><span class="va">Uvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">u1</span>, <span class="va">u2</span>, <span class="va">u3</span>, <span class="va">u4</span><span class="op">)</span></span>
<span><span class="va">Fvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">nMat</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Avals</span> <span class="op">&lt;-</span> <span class="va">Uvals</span></span>
<span><span class="va">Avals</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Avals</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="va">Fvals</span></span>
<span></span>
<span><span class="va">Alist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Avals</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="va">matrix</span>,</span>
<span>  byrow <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Next we use <code><a href="../reference/cdb_build_cdb.html">cdb_build_cdb()</a></code> to convert this list of
matrices into a COMPADRE object. Here I am adding an identifier to each
matrix, and a column for the shape parameter for the Gamma distribution
used to simulate the data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>idNum <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, shapeParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cdb_build_cdb.html">cdb_build_cdb</a></span><span class="op">(</span>mat_a <span class="op">=</span> <span class="va">Alist</span>, metadata <span class="op">=</span> <span class="va">meta</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in cdb_build_cdb(mat_a = Alist, metadata = meta): Metadata does not include a `SpeciesAccepted` column, so number</span></span>
<span><span class="co">#&gt;               of species not provided when viewing object.</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt; A COM(P)ADRE database ('CompadreDB') object with ?? SPECIES and 20 MATRICES.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 3</span></span></span>
<span><span class="co">#&gt;    mat        idNum shapeParam</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>     1          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>     2          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>     3          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>     4          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>     5          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>     6          2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>     7          2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>     8          2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>     9          2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    10          2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    11          3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    12          3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    13          3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    14          3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    15          3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    16          4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    17          4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    18          4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    19          4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    20          4</span></span></code></pre></div>
<p>We can look at the matrices using the normal <code>Rcompadre</code>
function <code><a href="../reference/CompadreMatrixMethods.html">matA()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/CompadreMatrixMethods.html">matA</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;           [,1]       [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.2664835 0.81467771</span></span>
<span><span class="co">#&gt; [2,] 0.6527664 0.05590771</span></span></code></pre></div>
<p>Now the matrices are stored in a <code>CompadreDB</code> object they
can be manipulated in the same diverse ways as the
<code>CompadreDB</code> object downloaded from the COMPADRE/COMADRE
database.</p>
<p>For example, filtering based on part of the metadata, in this case,
<code>shapeParam</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">shapeParam</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; A COM(P)ADRE database ('CompadreDB') object with ?? SPECIES and 10 MATRICES.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span><span class="co">#&gt;    mat        idNum shapeParam</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    11          3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    12          3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    13          3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    14          3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    15          3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    16          4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    17          4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    18          4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    19          4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">&lt;CompdrMt&gt;</span>    20          4</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="including-stage-descriptions-and-version-information">Including stage descriptions and version information<a class="anchor" aria-label="anchor" href="#including-stage-descriptions-and-version-information"></a>
</h2>
<p>In the above example, I did not include any information about the
stage definitions. Since these information were not provided,
<code><a href="../reference/cdb_build_cdb.html">cdb_build_cdb()</a></code> automatically creates some information. You
can view that information like this (using square brackets to choose a
particular matrix model):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/CompadreMatrixMethods.html">matrixClass</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;   MatrixClassOrganized MatrixClassAuthor MatrixClassNumber</span></span>
<span><span class="co">#&gt; 1               active                 1                 1</span></span>
<span><span class="co">#&gt; 2               active                 2                 2</span></span></code></pre></div>
<p>In the following example I illustrate how one can include
descriptions of the stages</p>
<p>First I create a data frame describing the matrix stages.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">stageDescriptor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  MatrixClassOrganized <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"active"</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  MatrixClassAuthor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"small"</span>, <span class="st">"large"</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   MatrixClassOrganized MatrixClassAuthor</span></span>
<span><span class="co">#&gt; 1               active             small</span></span>
<span><span class="co">#&gt; 2               active             large</span></span></code></pre></div>
<p>In this case, all stages are the same and I can simply repeat the
<code>stageDescriptor</code> in a list. However, the size of these data
frames, and the information within them may vary.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stageDesc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">stageDesc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">stageDescriptor</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cdb_build_cdb.html">cdb_build_cdb</a></span><span class="op">(</span></span>
<span>  mat_a <span class="op">=</span> <span class="va">Alist</span>, metadata <span class="op">=</span> <span class="va">meta</span>, stages <span class="op">=</span> <span class="va">stageDesc</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"Matrices Rock!"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in cdb_build_cdb(mat_a = Alist, metadata = meta, stages = stageDesc, : Metadata does not include a `SpeciesAccepted` column, so number</span></span>
<span><span class="co">#&gt;               of species not provided when viewing object.</span></span></code></pre></div>
<p>Now you can access the stage/class description information like this,
using square brackets to find the information for particular
matrices.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/CompadreMatrixMethods.html">matrixClass</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;   MatrixClassOrganized MatrixClassAuthor MatrixClassNumber</span></span>
<span><span class="co">#&gt; 1               active             small                 1</span></span>
<span><span class="co">#&gt; 2               active             large                 2</span></span>
<span><span class="fu"><a href="../reference/CompadreMatrixMethods.html">MatrixClassAuthor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] "small" "large"</span></span></code></pre></div>
<p>You can also obtain the version information.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/CompadreDB.html">Version</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Matrices Rock!"</span></span>
<span><span class="fu"><a href="../reference/CompadreDB.html">DateCreated</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "2024-10-16"</span></span></code></pre></div>
<p>The newly-created database can be saved like this:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">y</span>, <span class="st">"myMatrixDatabase.Rdata"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Caswell, H. (2001). Matrix Population Models: Construction, Analysis,
and Interpretation. 2nd edition. Sinauer Associates, Sunderland, MA.
ISBN-10: 0878930965</p>
<p>Salguero-Gomez, R. , Jones, O. R., Archer, C. R., Buckley, Y. M.,
Che-Castaldo, J. , Caswell, H. , Hodgson, D. , Scheuerlein, A. , Conde,
D. A., Brinks, E. , Buhr, H. , Farack, C. , Gottschalk, F. , Hartmann,
A. , Henning, A. , Hoppe, G. , Romer, G. , Runge, J. , Ruoff, T. ,
Wille, J. , Zeh, S. , Davison, R. , Vieregg, D. , Baudisch, A. ,
Altwegg, R. , Colchero, F. , Dong, M. , Kroon, H. , Lebreton, J. ,
Metcalf, C. J., Neel, M. M., Parker, I. M., Takada, T. , Valverde, T. ,
Velez-Espino, L. A., Wardle, G. M., Franco, M. and Vaupel, J. W. (2015),
The COMPADRE Plant Matrix Database: an open online repository for plant
demography. J Ecol, 103: 202-218. &lt;:10.1111/1365-2745.12334&gt;</p>
<p>Salguero-Gomez, R. , Jones, O. R., Archer, C. R., Bein, C. , Buhr, H.
, Farack, C. , Gottschalk, F. , Hartmann, A. , Henning, A. , Hoppe, G. ,
Romer, G. , Ruoff, T. , Sommer, V. , Wille, J. , Voigt, J. , Zeh, S. ,
Vieregg, D. , Buckley, Y. M., Che-Castaldo, J. , Hodgson, D. ,
Scheuerlein, A. , Caswell, H. and Vaupel, J. W. (2016), COMADRE: a
global data base of animal demography. J Anim Ecol, 85: 371-384.
&lt;:10.1111/1365-2656.12482&gt;</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patrick Barks, Danny Buss, Roberto Salguero-Gomez, Iain Stott, William K. Petry, Tamora James, Owen Jones, Julia Jones, Gesa Römer, Sam Levin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
